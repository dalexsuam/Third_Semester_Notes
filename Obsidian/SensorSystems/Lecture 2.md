
Date: 25/09/2025
***

 Today we'll see light sensors. Specially we'll delve into
 * Photodiode
 * Avalanche Photodiode, Single-photon Avalanche diodes and Silicon Photomultiplier
 * Light Dependent Resistors


Let's start with photodiodes :) 

# <span style="color:rgb(223, 109, 109)">Photodiode</span> 

A **photodiode** is essentially a standard diode whose current is influenced by the intensity of incident light. It has two terminals: the **anode** and the **cathode**.

The device is typically packaged with a **transparent window** that allows light to reach the **active area**, which is the part of the detector that responds to light. 

| Device                               | Electronic Schematic                 |
| ------------------------------------ | ------------------------------------ |
| ![[Pasted image 20250926181827.png]] | ![[Pasted image 20250926181841.png]] |
![[Pasted image 20250926182747.png]]

For visible light detection, this active area is usually a **silicon chip**. The chip is connected to the package terminals using **fine gold wires**, a process known as **wire bonding**, which provides a reliable electrical connection between the silicon and the external leads.

## <span style="color:rgb(239, 179, 1)">Photodiode: cross-section</span> 
![[Pasted image 20250926182804.png]]

This is the typical cross-section of a photodiode. We see there is a p-n junction, in which a n+ cathode is directly in contact with the p+ of the diode. 

* In n+ there are many free electrons (free carriers)
* In p+ there are many holes (lack of electrons)

When we put in contact these two regions, electrons and holes recombine at the junction and they create the **depletion region**.

<span style="font-weight:bold; color:rgb(161, 40, 226)">Depletion region</span>: It is a region without free carriers. **This can be model as a capacitor** because we don't have any free carriers in the middle of the two conductive plates of the capacitor (p+ and n+).

We can note that the p+ is inserted in the n+ type substrate and this p+ present a higher concentration of holes than the p+ and **this is the reason why the depletion region is more extended w.r.t p+ region**

Inside the depletion region free carriers can be generated by two mechanisms.
* Photo-generation
* Thermal-generation

<span style="font-weight:bold; color:rgb(161, 40, 226)">Photo-generation</span>: When an electron-hole pair is generated by absorbing a photon that reaches the inside of the depletion region

<span style="font-weight:bold; color:rgb(161, 40, 226)">Thermal generation</span>: The electron-hole pair is generated by the Brownian motion of the particles inside of the material.

## <span style="color:rgb(239, 179, 1)">Operation Mode</span>

| ![[Pasted image 20250926183735.png]] | In order to allow the production of electron-hole pairs by means of the photo-generation or thermal generation we have to perform a reverse bias on the diode. This means that the voltage in the cathode needs to be higher than the voltage applied in the anode.<br> |
| ------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
$$
V_{cathode}>V_{anode}
$$

Here we can see the plot of the V vs. I characteristic curve of a standard diode. The shape of this characteristic is pretty similar to a standard diode.

In forward region, when: $V_{anode}>V_{cathode}$ presents an exponential relation between voltage and current.

![[Pasted image 20250926184042.png]]
In this case, when the detector is reversed-bias. The green region, the characteristic is sort of flat until we reach the break-down voltage. We can also note that the characteristic curve shifts down if we increase the incident light that is hitting the active area of the photodiode, these three $P_0, P_1, P_2$  are distinguishable in reversed-bias before the breakdown-voltage (This is the reason we do reversed-bias).


| 1. Electron/Hole pairs generation                                                                                                         | 2. Carriers are attracted by reverse bias                                                                                         | 3. Carriers form a photoelectric current                                                                                                        |
| ----------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------- |
| ![[Pasted image 20250926184819.png]]                                                                                                      | ![[Pasted image 20250926184911.png]]                                                                                              | ![[Pasted image 20250926185020.png]]                                                                                                            |
| When the photon reaches the active area of the photodiode and are absorbed within the depletion region, they generate electron-hole pairs | This electron-hole pairs are then separated by the electrical field present in the depletion region produced by the reverse-bias. | This carriers and holes and the gathered from the anode and the cathode and they form a current which can be measured with an external circuit. |
<span style="font-weight:bold; color:rgb(2, 141, 192)">What if a photon is not absorbed in the depletion region but in the p+ or n+ region?</span>

It can still generate the electron-hole pair but the electron or the hole (depending on the region they were generated fell into) will recombine with the electrons or holes of the region and then they wouldn't contribute to produce the current. **We can only measure those photons which fall into the depletion region**

==The thickness of the depletion region is related to the efficiency of detecting incident photons==

## <span style="color:rgb(239, 179, 1)">p-n vs p-i-n</span> 

It is very important to have a wide or thick depletion region! Instead of using the normal p-n junction we use an intrinsic layer in the structure p-i-n.

The intrinsic layer is a layer in which silicon is lightly doped or undoped.


| p-n                                  | p-i-n                                |
| ------------------------------------ | ------------------------------------ |
| ![[Pasted image 20250926203747.png]] | ![[Pasted image 20250926203758.png]] |
So, we can appreciate the difference between the two structures and in case of the p-i-n we might say that the "depletion region" corresponds to the space between the p and the n region which is the intrinsic layer of undoped silicon.

==The typical thickness of depletion region that can be achieved in the p-n structure is in the order of few $\mu m$, in the p-i-n can be in the order of tenths of $\mu m$==

## <span style="color:rgb(239, 179, 1)">Advantages of thick depletion region</span> 

* We can reduce the capacitance associated in the detector. If the two plates of the capacitances have more space in between, the value of the capacitance reduces. Remember that

$$
C=\frac{\epsilon_0A}{d}
$$
This is particularly convenient for certain circuits to have a reduced capacitance
* Higher responsivity, that is, a higher probability to detect incoming photons and in a wider spectrum range, extending it to even the near-infrared region

## <span style="color:rgb(239, 179, 1)">Penetration depth </span> 

The **penetration depth** is the depth at which the intensity of incoming radiation is reduced to approximately **37% of its original value** when hitting on a detector.

![[Pasted image 20250926211120.png]]

The **penetration depth** is the depth at which about **63% of the incoming photons are absorbed and can be detected**. This depth depends on the **wavelength of the photons**.

- **Shorter wavelengths** correspond to more energetic photons, which are absorbed more quickly, resulting in a **lower penetration depth**. For example, at 400 nm, the penetration depth is about **0.1 µm**.

- **Longer wavelengths** correspond to less energetic photons, which penetrate deeper, requiring a **thicker depletion region** to detect them efficiently. For instance, photons at 1000 nm require about **100 µm** of junction thickness to detect more than 63% of the photons.
    
For **even longer wavelengths**, such as in the mid-infrared, another limitation arises: the photon energy must be sufficient to **create an electron-hole pair**, i.e., to overcome the **material’s energy gap**. In silicon, the energy gap is **1.12 eV**, corresponding roughly to a photon wavelength of **1.1 µm**. This is why **silicon photodiodes cannot detect photons in the mid-infrared region**.
$$
E_{ph}>E_{g}
$$
## <span style="color:rgb(239, 179, 1)">Photodiode Responsivity</span> 

We can also evidence the fact of not being able to detect wavelengths larger than 1.1$\mu m$ in the photodiode responsivity plot. 

Responsivity is the term we use for photodiodes to device their sensitivity, the ratio between the output and the input. The output is the intensity of the photocurrent and the input is the power of the incoming light at a given wavelength and we see that responsivity depends on the wavelength of the incoming radiation. In particular, as we expect, we have a drop almost to 0 when we get to 1.1 micrometer cos the energy is no enough to overcome the energy gap, but also it is 0 for very high energy photon, near-UV, this is because the penetration depth near UV is very short, and we have a very high probability to generate the electron-hole pair not in the depletion region but in the p+ before reaching the depletion region, as we already mention, if this happens, the electron generated would recombine with the free holes in that p+ region and won't contribute to the current. The responsivity not only depends on the wavelengths but also on the reverse bias if we're using a standard p-n junction, cos the higher the reverse voltage, the thicker the depletion region and the higher the probability to detect photons, the higher the responsivity. 

The responsivity also depends on temperature, it is not straight forward, if we look at the graph, the temperature coeff vs wavelenght it is not constant, and for some wavelenghts is negative and for some is positive. In negative temperature coefficients, it means that if we increase the temperature, the responsivity would decrease, if we increase the temperature in a positive coefficient, the responsivity would increase.

Why this happens in diff wavelenghts? Mainly cos temperature behavior in responsivity is determined by diff factors with opposite impact on these characteristics. For some wavelenghts (short) the factors dominants are different for those that are dominant in higher and this explains this strange temperature behavior that we have in photodiodes.

The **responsivity** of a photodiode describes its sensitivity and is defined as the ratio between the **output photocurrent** and the **input optical power** at a given wavelength. It depends strongly on the wavelength of the incoming light, the applied reverse bias, and the temperature.

$$
R_{\lambda}=\frac{I_{ph}}{P}
$$

![[Pasted image 20250926214927.png]]
From the responsivity plot, we can observe that photodiodes **cannot detect wavelengths longer than 1.1 μm**. This is because the photon energy becomes insufficient to overcome the silicon bandgap, so no electron-hole pairs are generated. Conversely, responsivity is also very low for **high-energy (near-UV) photons**. In this case, the penetration depth is very short, so electron-hole pairs are mostly generated in the p⁺ region before the depletion zone. These electrons tend to **recombine with free holes** in the p⁺ region and do not contribute to the photocurrent.

The **reverse bias voltage** also affects responsivity. Increasing the reverse voltage thickens the depletion region, which **increases the probability of photon detection** and thus enhances responsivity.
![[Pasted image 20250926214943.png]]
Responsivity is further influenced by **temperature**, but the effect is not straightforward. The temperature coefficient of responsivity varies with wavelength: at some wavelengths it is **positive** (responsivity increases with temperature), and at others it is **negative** (responsivity decreases with temperature). This complex behavior arises because different mechanisms dominate at different wavelengths, with opposing effects on the photodiode’s performance.

## <span style="color:rgb(239, 179, 1)">Photodiode - Electrical model</span> 

![[Pasted image 20250926225042.png]]

Studying the **equivalent electrical circuit** of a photodiode is important for analyzing both the **noise sources** and the **front-end electronics** that can be connected to it.

The model includes the following components:
1. **Current Sources**

    - **Photocurrent**: generated by incident light.        
    - **Dark current**: generated by thermal electron-hole pair creation, even in the absence of light.
        
2. **Junction Capacitance ($C_j$​)**
    
    - Models the depletion region
    - Can be calculated as:
        
        $C_j = \frac{\varepsilon A}{W_d}$
        
        where $\varepsilon$ is the permittivity of the material, A is the active area, and $W_d$​ is the depletion width.
        
2. **Shunt Resistance ($R_{sh}$​)**
![[Pasted image 20250926225009.png]]
    - Connected in parallel with the junction capacitance.
    - Represents the fact that the reverse-bias I–V curve is not perfectly flat but has a small slope.
    - Typically very large (in the order of MΩ), since the curve is almost flat.
        
3. **Series Resistance ($R_s$​)**
    
    - Represents resistances from the non-depleted regions of the p–n junction, as well as contact resistances at the terminals.

    - Typically small compared to the other elements.

![[Pasted image 20250926224741.png]]
$$R_s= \frac{(W_s-W_d)\cdot\rho}{A}+R_c
$$
## <span style="color:rgb(239, 179, 1)">Thermal noise and shot noise</span> 

**Electrical noise** are random fluctuations that get superimposed on the useful signal. In practice, even if we expect a clean signal (e.g., a sinusoid), what we actually measure is the signal plus random fluctuations — the noise.

![[Pasted image 20250927085744.png]]

In photodiodes, the main noise contributions come from the **elements of the equivalent electrical circuit**.

<span style="font-weight:bold; color:rgb(161, 40, 226)">Thermal (Johnson) noise</span>: Thermal noise is caused by the **Brownian motion of charges within resistors**. Consider a resistor with two open terminals: although no current flows through it, free carriers inside are constantly moving. On average, they are evenly distributed, but due to statistical fluctuations, at a given moment more carriers may be concentrated on one side than the other. This imbalance can produce an instantaneous voltage difference, even when no external current is present.

This phenomenon can be represented electrically with a **Thevenin equivalent** (voltage noise source) or a **Norton equivalent** (current noise source). What these equivalents describe is the **spectral density of the noise**, meaning the noise contribution per unit frequency.


![[Pasted image 20250927085945.png]]

For **thermal noise**, the spectral density is flat over frequency. This makes it a form of **white noise**.

| Thevenin Equivalent                                     | Norton Equivalent                                          |
| ------------------------------------------------------- | ---------------------------------------------------------- |
| ![[Pasted image 20250927090853.png]]                    | ![[Pasted image 20250927090902.png]]                       |
| $$S_v= 4KT\cdot R \space \left[ \frac{V^2}{Hz}\right]$$ | $$S_i= \frac{4KT}{R} \space \left[ \frac{A^2}{Hz}\right]$$ |
Where $K$ is the Boltzmann constant and $T$ the absolute temperature.  At room temperature,

$$
4KT=1.66\cdot10^{-20} \left[ \frac{V^2}{Hz\cdot \Omega} \right]
$$

<span style="font-weight:bold; color:rgb(161, 40, 226)">Shot Noise: </span> The second source of noise is **shot noise**, which arises from the **granularity of electric charge** crossing a junction.

When we measure a current, what we actually observe is the **average number of electrons** passing through the junction per unit time. However, since electrons are discrete particles, the exact number crossing in any instant can fluctuate. These random fluctuations in the electron flow are what give rise to shot noise.

The spectral density of shot noise is expressed as:

![[Pasted image 20250927091731.png|200]]
$$
S_i=2q\cdot I \space \left[ \frac {A^2}{Hz} \right]
$$
where $q$ is the electron charge and $I$ is the average current.

This expression shows that the noise is **proportional to the current** through the junction. Since the formula does not depend on frequency, shot noise is also a form of **white noise**, with a **flat spectral density** across frequency.

To evaluate the impact of noise on a signal, the **spectral noise density** alone is not very convenient, because its units are squared (e.g., $V^2/Hz$ or $A^2/Hz$). What we really need is a measure that allows us to **compare noise levels directly with the signal**.

Since the **average value of noise is always zero**, the meaningful quantity is its **standard deviation**, which reflects the typical amplitude of noise fluctuations.

The standard deviation of the noise can be calculated as:

$$
\sigma_v= \sqrt{S_v \cdot \Delta f} \space \text, \space \sigma_i= \sqrt{S_i \space \cdot \Delta f}
$$
where $\Delta f$ is the **bandwidth of interest**.
- This gives the noise amplitude either as **voltage** or **current**, depending on the spectral density considered.
- Unlike the average value of the noise (always zero), the **standard deviation** provides meaningful information about the noise amplitude relative to the signal.

The bandwidth of interest is determined by the **readout circuit**, the **parasites**, or the **sensor itself**.
* For a **single-pole circuit**:
$$
\Delta f = \frac{\pi}{2}\cdot f_p \space \rightarrow f_p= \frac{1}{2\pi CR_{eq}}
$$
Where $f_p$ is the frequency of the pole
$$\Delta f = \frac{1}{4CR_{eq}}$$
For a system with a **more complex transfer function** (not only a single pole), the effective bandwidth $\Delta f$ must be computed accordingly.

## <span style="color:rgb(239, 179, 1)">Photodiode Noise</span> 

We are now going to evaluate the noise contributions in the electrical model of the photodiode.

Starting with shot noise

![[Pasted image 20250927093718.png]]

<span style="font-weight:bold; color:rgb(161, 40, 226)">Shot noise</span>: We said that the spectral density of the shot noise is 
$S_i=2q\cdot I$, then if we want to compute the noise standard deviation we have that

$$
\sigma_i= \sqrt{2q(I_{ph}+I_d)\cdot\Delta f}
$$
We have to multiply by the bandwidth of interest, and take the square root of it. Here, the current that contributes to shot noise is the **total current crossing the junction**, which includes: the **photocurrent** $I_{ph}$​, and the **dark current** $I_d$.
    
Thus, both contribute to the fluctuations described by shot noise.

<span style="font-weight:bold; color:rgb(161, 40, 226)">Thermal noise:</span> We can now compute the contribution of the thermal noise of the two resistors. 

Let's redraw it to obtain the noises to get the output of this noise as an output current, considering also a load resistance = 0. 

![[Pasted image 20250927102735.png]]
We define the noise contribution from $R_{sh}$ is described as
$$S_{I_{sh}} = \frac{4KT}{R_{sh}}$$
![[Pasted image 20250927102750.png]]
And we'll see that this current source would contribute to the output noise current from two sides, one circulating through $R_{sh}$ and another contribution that is going to $R_s$ .

The contribution of the current going to $R_s$ is the same as the one at the output. Then the contribution at the output is basically a current divider, 

![[Resistance Thermal Noise.pdf]]

Then we have that 

$$
S_{I_{out}}= S_{I_{sh}}\cdot \left( \frac {R_{sh}}{R_{sh}+R_s} \right)^2
$$
And now, we can easily compute the standard deviation of the noise
$$
\sigma_{i_{R_{sh}}}=\sqrt{S_{I_{out}}\cdot \Delta f}
$$
$$
\sigma_{i_{R_{sh}}}=\sqrt{S_{I_{sh}}\cdot \left( \frac {R_{sh}}{R_{sh}+R_s} \right)^2 \cdot \Delta f}
$$
$$
\sigma_{i_{R_{sh}}}=\sqrt{\frac {4KT}{R_{sh}}\cdot \left( \frac {R_{sh}}{R_{sh}+R_s} \right)^2 \cdot \Delta f}
$$
We simplify it, and if of course we have into account that the resistance $R_s$ is small w.r.t the resistance $R_{sh}$ we can say that.
$$\sigma_{i_{R_{sh}}}=\sqrt{\frac {4KT \cdot R_{sh}}{(R_{sh}+R_s)^2} \cdot \Delta f} \rightarrow \space \sigma_{i_{R_{sh}}}=\sqrt{\frac {4KT}{R_{sh}} \cdot \Delta f}$$
Finally,
$$
\sigma_{i_{R_{sh}}} \approx \sqrt{\frac {4KT}{R_{sh}} \cdot \Delta f}$$

Then this would be the resulting contribution of the spectral noise density of the resistance $R_{sh}$ thermal noise at the output.

> [!NOTE] We didn't take into account the capacitor because if we are computing the noise contributions we do it in DC, in which capacitor behaves as an open circuit. However, when computing the noise standard deviation we are not excluding the capacitor because it is in this bandwidth of interest where the capacitor would be introducing the poles/zeroes. 

Now, the second contribution which is the one of $R_s$ 

 ![[Pasted image 20250927105239.png]]
 So, the previous would be the noise spectral density. However, what we're interested in is the noise standard deviation. Thus, 
$$
\sigma_{i_{Rs}}=\sqrt{S_{I_{s}}\cdot \left( \frac {R_{s}}{R_{sh}+R_s} \right)^2 \cdot \Delta f}
$$
$$
\sigma_{i_{Rs}}=\sqrt{\frac {4KT}{R_{s}}\cdot \left( \frac {R_{s}}{R_{sh}+R_s} \right)^2 \cdot \Delta f}
$$
And we can simplify it
$$
\sigma_{i_{Rs}}=\sqrt{\frac {4KT \cdot R_{s}}{(R_{sh}+R_s)^2} \cdot \Delta f}
$$
And again if we consider that $R_s << R_{sh}$. We finally get as a result
$$
\sigma_{i_{Rs}}\approx \sqrt{\frac {4KT \cdot R_{s}}{R_{sh}^2} \cdot \Delta f}
$$

==And look that if we do the following mathematical manipulation==
$$
\sigma_{i_{Rs}}\approx \sqrt{\frac {4KT}{R_{sh}} \cdot \Delta f \cdot \frac{R_{s}}{R_{sh}} }
$$
$$
\sigma_{i_{Rs}}\approx \sigma_{i_{Rs} \cdot \sqrt {{R_{s}}/{R_{sh}}}}
$$ In which the factor $\sqrt{R_{s}/R_{sh}} <<1$ <span style="font-weight:bold; color:rgb(2, 141, 192)">Then this noise contribution is negligible </span>

---
In practice, photodiode datasheets rarely provide the separate variances of **thermal noise** and **shot noise**. Instead, they typically report a single parameter called the **Noise Equivalent Power (NEP)**.

## <span style="color:rgb(239, 179, 1)">Noise Equivalent Power </span> 

The **Noise Equivalent Power (NEP)** of a photodiode is the **amount of incident optical power required to generate a photocurrent equal in amplitude to the noise current**. In other words, it represents the minimum detectable optical power: the point where the signal-to-noise ratio (SNR) equals 1, measured in a 1 Hz bandwidth.

Let's recall that the responsivity is defined as:
$$R_{\lambda}=I_{ph}/P$$
Which corresponds to the output signal/input signal, this means, the ratio between the photogenerated current and the power of the incident photon.

**In the Noise Equivalent Power (NEP)** we have that:
$$
NEP = \frac {I_n}{R_\lambda}
$$
And that responsivity is associated to the amount of light power needed to produce a current equal to the noise current $I_n$ 

So, let's think about

## <span style="color:rgb(239, 179, 1)">Noise SPICE simulations</span>

To understand the previously computed contributions of noise, we performed **two simulations** that yielded the same results.


| **Commercial photodiode model**      | **Electrical Model of Photodiode**   |
| ------------------------------------ | ------------------------------------ |
| ![[Pasted image 20250927121812.png]] | ![[Pasted image 20250927121822.png]] |

1. In the **first simulation**, we used the **commercial photodiode model** provided by the manufacturer.    
2. In the **second simulation**, we analyzed the photodiode datasheet and extracted the **junction capacitance, shunt resistance, and series resistance**. We then replaced the manufacturer model with an **equivalent electrical circuit** using these parameters.
    
Both simulations produced **exactly the same results**, confirming that the manufacturer’s model is based on the same electrical representation we have studied.

In these simulations, the software provides the **noise spectral current density** passing through the read-out resistor $R_1$​. Although we are not focusing on the front-end circuit, the read-out resistor is nearly zero, which is equivalent to the case we analyzed previously.

We have observed that the **series resistance ($R_s$​)** and the **shunt resistance ($R_{sh}$​)** contribute differently to the **spectral noise current density** at the output. Each resistance affects the noise depending on the current path and the current-divider effect in the photodiode equivalent circuit.

First, let's see the contribution of $R_{sh}$

<span style="font-weight:bold; color:rgb(161, 40, 226)">Rsh Contribution </span>: It introduces a single pole at about 5 GHz and this is given by
$$
f_p=\frac {1}{2\pi C_j\cdot (R_s||R_{sh})}
$$
![[Pasted image 20250927122338.png]]

<span style="font-weight:bold; color:rgb(161, 40, 226)">Rs Contribution</span>: It introduces the same pole given by $R_{sh}$ at ~5 GHz, but it also inserts a zero given by
$$
f_z=\frac{1}{2\pi C_j R_{sh}}
$$
![[Pasted image 20250927122605.png]]

 
 **Is the $R_s$ contribution negligible w.r.t to $R_{sh}$ ?** We compute the ratio between both noise spectral densities and we see that we have at the end:
![[Pasted image 20250927122803.png]]

We observe that at **low frequencies**, the ratio of noise contributions is **greater than 1**, indicating that the **shunt resistance ($R_{sh}$) dominates** compared to the series resistance ($R_s$​). As the frequency increases and passes the **zero in the transfer function of $R_s$​**, the contribution of $R_s$​ begins to grow, and the ratio between $R_{sh}$​ and $R_s$​ decreases. This means that at **higher frequencies**, the **series resistance becomes increasingly significant** in the output noise.

For this photodiode, the **zero occurs at 54 kHz**, which is considered a **large bandwidth** for typical read-out circuits.

## <span style="color:rgb(239, 179, 1)">Basic Read-out circuits</span> 

We have two possible read-out circuits configurations based on: non-inverting and transimpedance amplifier

* <span style="font-weight:bold; color:rgb(161, 40, 226)">Non-Inverting configuration</span>: 

The following configuration was taken from a datasheet that provides us a configuration for a photodiode read-out. However, let's make in parallel the highlight of the most crucial components of this configuration.

| ![[Pasted image 20250927154309.png]] | ![[Pasted image 20250927155116.png]] |
| ------------------------------------ | ------------------------------------ |
|                                      | ![[Pasted image 20250927155127.png]] |
But, let's analyze the "complex" schematic. Step by step.


| ![[Pasted image 20250927155309.png]]                                                                                                                                                                                                                                                                                      | First of all: We have the capacitors and resistor in order to provide a filtering in the power-supply to have it stable for the bias of the photodiode. :)                                                                                                      |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ![[Pasted image 20250927155521.png]]                                                                                                                                                                                                                                                                                      | Then, we have that the operational amplifier doesn't only have the arrange of resistors that we use in order to have the non-inverting configuration. But, we also have those $0.1 \mu F$ capacitors in order to also provide an stable power supply to the OpA |
| ![[Pasted image 20250927155728.png]]Last but not least we have that circle representing a coaxial cable which is typically used to connect our circuits with external instrumentation. $51 \Omega$ resistor is needed to make impedance matching with the coaxial cable to not suffer of any electromagnetic reflections. |                                                                                                                                                                                                                                                                 |
Also, we have to note that the resistor $R_f$ was split in two resistors, because resistance values are discretized and if we have resistors in series we have more flexibility in choosing the total resistance.

Look at the greenish node $V$

![[WhatsApp Image 2025-09-27 at 16.06.39_b4d401b1.jpg]]


>[!WARNING] The main limitation of the simple load-resistor readout is that the reverse bias across the photodiode is not constant: it depends strongly on the photocurrent amplitude. In the usual arrangement the anode voltage equals the photocurrent multiplied by the load resistor $R_L$. If the photocurrent increases, the voltage across $R_L$​ rises and the reverse voltage across the diode decreases. This can lead to a form of saturation: reducing the reverse bias reduces the depletion width, which in turn lowers the photodiode responsivity.

How to solve this? Let's look at the transimpedance configuration

* <span style="font-weight:bold; color:rgb(161, 40, 226)">Transimpedance amplifier</span> 

Let's again have in parallel the "complex" and simplified circuit.

| ![[Pasted image 20250927160825.png]] | ![[WhatsApp Image 2025-09-27 at 16.16.23_6ac553ba.jpg]] |
| ------------------------------------ | ------------------------------------------------------- |
|                                      | ![[WhatsApp Image 2025-09-27 at 16.16.23_450328a6.jpg]] |
We see that again, here we produce a photocurrent by reverse bias of the photodiode, and the output of the circuit would be the voltage drop in the $R_f$ resistor. 

Let's delve into the "complex" circuit again...

| ![[Pasted image 20250927161904.png]] | We have again some filtering for the power supply of the reverse bias.                                                                                      |
| ------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ![[Pasted image 20250927161936.png]] | Again some filtering for the power supply of the operational amplifier.                                                                                     |
| ![[Pasted image 20250927162014.png]] | And we see again the $R_f$ resistor divided in two resistors, and the $51\Omega$ resistor to do the impedance matching with the coaxial cable to reflection |
>[!success] The main advantage of this circuit is that the **reverse voltage applied to the photodiode remains independent of the photocurrent**. This is because the **anode of the photodiode is held at ground potential** by the **virtual ground of the operational amplifier**, which is fixed at 0 V. The presence of a virtual ground also implies that the **equivalent input resistance seen from the front-end circuit is essentially zero**.

**What is the main limitation of this configuration?** It requires some compensation because it presents un-stability that causes oscillations in the output.

Let's give it a look in a SPICE simulation :)

| ![[Pasted image 20250927162709.png\|4000]] | This is the simulated circuit. TIA, the highlighted current generator is the $I_{ph}$ and the capacitance is $C_j$ the junction capacitance. $R_1$ is the resistance that we called $R_f$ (Feedback resistance of TIA) |
| ------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
In a first approach, let's imagine we have no $C_C$ compensation capacitance, and we are going to provide a square pulse to simulate the presence of light, low (no light), high (light). The photocurrent would also have this shape.
![[Pasted image 20250927163027.png]]
The current would be send to the resistance $R_1$ and we expect to have the same voltage response. However, if we don't include $C_c$ we have some unwanted oscillations in each rising and falling edges as shown below.
![[Pasted image 20250927163250.png]]

Now, you can see that if we include the capacitor $C_c$ and also we increase we can attenuate/smooth this unwanted oscillations from the signal, in particular a value in which the oscillation can be completely negligible and this is how the compensation is performed.

>[!Warning] There must be a trade-off of this $C_c$ value because the insertion of this would represent a new pole that would at the end reduce the bandwidth of the circuit and we so wouldn't be able to distinguish very fast variations of the light in time.

<span style="font-weight:bold; color:rgb(161, 40, 226)">Light Integration</span>: We can say that this configuration is quite similar to a **Transimpedance Amplifier (TIA)**, but instead of using a resistor, we use a **capacitor** in which the photocurrent is integrated.


| ![[Pasted image 20250927195355.png\|1000]] | ![[WhatsApp Image 2025-09-27 at 19.53.03_915f772c 1.jpg]] |
| ------------------------------------------ | --------------------------------------------------------- |
|                                            | ![[WhatsApp Image 2025-09-27 at 19.53.03_93355afe.jpg]]   |

Since we cannot integrate the photocurrent indefinitely (the op-amp would eventually saturate), we need to periodically discharge the capacitor to start a new integration cycle. For this reason, a **switch is placed in parallel with the capacitor**:

- When we want to **integrate the photocurrent**, we open the switch so that the current charges the capacitor.
- When we want to **reset the output to 0 V**, we close the switch to discharge the capacitor.

![[Pasted image 20250927195624.png]]
If the incident light arrives as **pulses**, the photocurrent will also be pulsed, with different amplitudes and durations. The expected output behaves as follows:

1. Initially, we might see a **random voltage** due to the initial condition of the capacitor.    
2. After a **reset**, the voltage is set to **0 V**.
3. When the **first light pulse** arrives, it generates a corresponding **pulse of photocurrent**, which is integrated over time. This appears as a **voltage ramp (slope)** across the capacitor.
4. If there is no light, no current flows, and the **voltage remains constant**.
5. A new light pulse produces another slope, further increasing the output voltage.
6. Eventually, the circuit is reset again, bringing the output voltage back to **0 V**.
$$
V_o=\frac{\overline{I_{sc}}\cdot t_o}{C}
$$

The **integrated charge** depends on the **average photocurrent** multiplied by the **integration time** (the time between two reset phases).

Such circuits are widely used in **imaging applications**. In image sensors based on photodiodes, the principle is to **integrate the incoming light during the integration time** (exposure), and then perform a reset at the end of the frame. In this way, the collected charge is directly related to the brightness of the image at each pixel.

## <span style="color:rgb(239, 179, 1)">Photodiode Applications</span> 

![[Pasted image 20250927200353.png]]
Photodiodes have a wide range of applications. In cameras, they are not directly responsible for reconstructing the image itself, but they are essential for tasks such as **autofocus**, **environmental light monitoring**, **automatic shooting control**, and **flash control**.

They are also widely used in the **medical field**. A common example is **photoplethysmography**, where photodiodes help measure the **oxygen saturation** in blood.

In **safety equipment**, photodiodes are applied to detect **smoke**, **presence**, or **intruders**.

In the **automotive sector**, they play a key role in **twilight detectors**, which automatically switch on the car’s lights when ambient light levels decrease.

In **industry**, photodiodes are found in **barcode scanners**, **rotary encoders**, and even in **copiers**, where they help monitor the **toner density**.

Finally, one of the most important areas of application is **communications**, particularly in **optical communications**, where photodiodes act as detectors converting optical signals back into electrical ones.

## <span style="color:rgb(239, 179, 1)">IR Receiver Module: TSOP58238</span> 

![[Pasted image 20250927200803.png]]

In our board we will use the **TSOP58238**, a photodiode-based **infrared receiver module**, as the detector in an optical communication system coupled with an **infrared LED transmitter**.

The module integrates a **p–i–n photodiode** together with its **front-end circuitry**. It also includes an **AGC (Automatic Gain Control)**, which dynamically adjusts the gain of the front-end circuit according to the incoming light intensity, preventing saturation. In addition, the device incorporates **filtering** stages and, most importantly, a **demodulator**.

The demodulator is crucial because the infrared light transmitted by the LED is **modulated at 38 kHz**, which is a standard in infrared optical communication. This modulation allows the system to **distinguish the LED signal from ambient light**. After demodulation, the useful information carried by the LED is recovered, and the module provides a **digital output** that can be directly interfaced with a **microcontroller** using standard communication protocols.

<span style="font-weight:bold; color:rgb(161, 40, 226)">Relative Spectral Sensitivity</span>: The **relative spectral sensitivity** describes how sensitive a photodiode is to different wavelengths of light, **normalized to 1 at the wavelength where the sensitivity peaks**.

For the TSOP58238 module, this sensitivity differs from that of a standard silicon photodiode:

- It **peaks at 950 nm**.
- It is **essentially zero for short wavelengths**, whereas a standard silicon photodiode is sensitive down to ~350 nm.
    

This unusual spectral response is **not due to the photodiode itself**, but rather to the **dark-black package** and the **internal filter** that only allows **infrared light** to pass through, effectively blocking visible light. package, we want to provide the filter only that will let pass only the infrared light.
![[Pasted image 20250927201159.png]]


<span style="font-weight:bold; color:rgb(161, 40, 226)">Relative Transmission Distance</span>: It represents the angular response to the incident light.

The **relative transmission distance** characterizes the **angular response** of the photodiode to incident light.

- When light is incident at **0°** (orthogonal to the photodiode surface), the device reaches its **peak sensitivity**.
- As the angle of incidence increases, the sensitivity decreases. For example, at an angle of **80°**, the relative sensitivity drops to about **0.35**.

This means that, to obtain the **same output signal** from the photodiode:

- A source placed at **0°** can be at a normalized distance of **1**.
- The same source at **80°** must be placed at a shorter distance, scaled by the factor **0.35**, to compensate for the reduced sensitivity.

In other words, the photodiode is most efficient when illuminated perpendicularly, and much less efficient at very oblique angles.
![[Pasted image 20250927225839.png]]

# <span style="color:rgb(223, 109, 109)">Avalanche Photodiode (APD)</span> 

The **Avalanche Photodiode (APD)** has a structure quite similar to that of a standard **p–i–n photodiode**. The key difference lies in its operating condition: the APD is **reverse-biased very close to the breakdown voltage**, though still slightly below it.

In this regime, the photocurrent generated is still **proportional to the incident light intensity**, but with an important distinction: the device provides an **internal multiplication gain**. This gain is typically on the order of **100**.

The process works as follows: when a photon is absorbed, it creates an **electron–hole pair**, just as in a normal photodiode. However, due to the high electric field near breakdown, these carriers gain enough energy to ionize other atoms in the semiconductor lattice, generating **additional electron–hole pairs**. This **avalanche multiplication effect** means that the output current corresponds to **many carriers generated from a single photon**, providing a built-in amplification mechanism.

![[Pasted image 20250927230610.png]]

Imagine that a **photon is absorbed** in the active region of the device, generating an **electron–hole pair**. The carriers then drift toward the **cathode**, and upon reaching the region with a **very large electric field** (created by biasing the diode with a reverse voltage close to the breakdown voltage), they are strongly accelerated.

In this **high-field region** (the p–n junction), the accelerated electrons collide with atoms in the lattice and release new carriers through **impact ionization**. In other words, they knock out bound electrons from the atoms, creating additional **electron–hole pairs**. This avalanche process can repeat many times, leading to a large multiplication of carriers from a single absorbed photon.

Structurally, the APD is similar to a **p–i–n photodiode**, but with a key modification: the **p region** is placed after the intrinsic region. This ensures a **spatial separation** between the **absorption region** (where photons are converted into carriers) and the **avalanche region** (where the high electric field is applied to trigger multiplication).

> [!Succees] The **main advantage** of the APD is its **high sensitivity**. Thanks to the internal gain, even a very small number of photons (sometimes just a few tens) can generate a detectable current that exceeds the noise level, something not achievable with a standard photodiode.

# <span style="color:rgb(223, 109, 109)">Single-Photon Avalanche-Diode (SPAD)</span>

The **Single-Photon Avalanche Diode (SPAD)** is a special type of photodiode designed to detect light at the **single-photon level**.

![[Pasted image 20250927232445.png]]
The device is based on a **p–n junction** biased **above the breakdown voltage**. Under this condition, when a **single photon** is absorbed in the depletion region and generates an **electron–hole pair**, the carriers are accelerated in the strong electric field and trigger a **macroscopic avalanche current**, typically in the order of milliamps.

![[Pasted image 20250927232525.png]]

This current is **self-sustaining (auto-sustaining)**: once the avalanche begins, it will continue indefinitely unless an **external circuit quenches** it. The quenching process lowers the bias voltage below the breakdown threshold to stop the avalanche. After quenching, a **reset phase** is required to restore the junction bias above the breakdown voltage, making the device ready for the next photon detection.

The SPAD therefore provides a **digital output**:

- **No photon → no current**.
- **One or more photons → a macroscopic current pulse**.
    

## <span style="color:rgb(239, 179, 1)"> Integration and Circuitry</span>
![[Pasted image 20250927232559.png]]

SPADs can be **easily integrated in standard CMOS technology**, which allows both the photodiode and the quenching circuitry (ranging from a simple resistor to more sophisticated circuits) to be fabricated on the same chip.

## <span style="color:rgb(239, 179, 1)">Limitation</span>

While SPADs are **extremely sensitive**—capable of detecting a single photon—they cannot distinguish the **number of photons**. Regardless of whether one photon or many photons arrive simultaneously, the result is always the same macroscopic avalanche current pulse.

This happens because, unlike standard photodiodes, in SPADs both **electrons (toward the cathode)** and **holes (toward the anode)** are accelerated, each capable of creating new electron–hole pairs. This **positive feedback** sustains the avalanche until quenched, erasing information about the initial photon count.

# <span style="color:rgb(223, 109, 109)">Silicon Photo-Multipliers</span> 

The main limitation of a **Single-Photon Avalanche Diode (SPAD)** is that it cannot distinguish the number of photons that triggered the avalanche. To overcome this, a **Silicon Photomultiplier (SiPM)** is designed as an array of many **SPADs connected in parallel**, each one equipped with its own **quenching resistor**.

![[Pasted image 20250927233201.png]]

## <span style="color:rgb(239, 179, 1)">Working Principle</span>

![[Pasted image 20250927233245.png]]
- If **one photon** arrives in a single SPAD cell, it triggers **one avalanche current**.
- If **two photons** arrive simultaneously but in **different SPAD cells**, two avalanches occur in parallel, producing a current that is **twice as large**.
- In general, the output current of the SiPM is the sum of the avalanches from all SPAD cells that fired, effectively allowing the device to **quantize the number of detected photons** in discrete steps.

## <span style="color:rgb(239, 179, 1)">Advantages</span>

- **Photon-number resolution**: Unlike a single SPAD, the SiPM can estimate the number of incident photons (within the limits of the number of SPAD cells).
- **Large active area**: Since the SiPM is made up of many SPADs in parallel, its effective sensitive area is much larger than that of an individual SPAD.

In this way, SiPMs combine the **single-photon sensitivity** of SPADs with the ability to **resolve multiple photons** and to cover a **larger detection surface**, which makes them widely used in applications like medical imaging (PET scanners), LIDAR, and particle physics detectors.

# <span style="color:rgb(223, 109, 109)">Light Dependent Resistor (LDR)</span> 

The **LDR** is one of the simplest light detectors. It is essentially a resistor whose value changes depending on the intensity of incident light:

- **In the dark**: it presents a **very high resistance** (megaohms).    
- **Under illumination**: the resistance **drops significantly**, even down to just a few ohms.

## <span style="color:rgb(239, 179, 1)">Working Principle</span>
![[Pasted image 20250927233838.png]]

The operation is based on the fact that the **resistivity of the material** depends on the **concentration of free electrons**.

- When light illuminates the material, photons excite electrons into the conduction band, increasing the number of free carriers.
- As a result, the resistivity decreases and so does the resistance of the device.
    
## <span style="color:rgb(239, 179, 1)">Limitations</span>

- **Non-linear response**: The relationship between resistance and light intensity is highly non-linear, with better sensitivity at **low illumination levels** but very poor performance under strong light.
    
- **Cross-sensitivity to temperature**: The resistance also varies significantly with **temperature**, making it difficult to distinguish whether a change in resistance is due to illumination or thermal effects.
    

Because of these drawbacks, **LDRs are not widely used** in modern precise optical detection systems. They are more common in simple, low-cost applications such as light switches, automatic night lamps, or basic brightness sensors.

## <span style="color:rgb(239, 179, 1)">LDR in On/Off Light Detection Circuits</span>

![[Pasted image 20250927234435.png]]

An LDR is often used in **basic switching circuits** to detect the presence or absence of ambient light. A common application is a circuit that **turns on an LED when illumination increases** and turns it off in the dark.

The circuit is built using a **voltage divider** formed by the LDR and a fixed resistor (typically 10 kΩ in series with a variable resistor for adjustment). The output of this divider is connected to the **base of a BJT transistor** that controls the LED.

- In **dark conditions**, the resistance of the LDR is very high. Because of this, the voltage at the base of the BJT is too low to turn it on. The transistor stays in cutoff, acting as an open switch, and no current flows through the LED. As a result, the LED remains **off**.
    
- In **illuminated conditions**, the resistance of the LDR decreases. This reduces its share of the voltage divider, raising the voltage at the base of the transistor. Once this voltage exceeds the base-emitter threshold, the transistor turns on and goes into saturation. In this state, the transistor connects the LED to ground, allowing current to flow, and the LED turns **on**.

## <span style="color:rgb(161, 40, 226)">Key Idea</span>

The LDR does not directly power the LED but rather acts as the **control element** in the voltage divider that biases the BJT. The BJT then acts as the **electronic switch**, enabling or disabling current flow through the LED depending on the amount of ambient light detected by the LDR.

